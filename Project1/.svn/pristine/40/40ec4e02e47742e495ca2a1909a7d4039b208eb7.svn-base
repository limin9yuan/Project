<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bootdo.workDay.dao.WorkDayDao">

	<select id="get" resultType="com.bootdo.workDay.domain.WorkDayDO">
		select `Holiday_Id`,`Holiday_Name`,`Start_Day`,`End_Day`
		from holiday
		where Holiday_Id = #{value}
	</select>

	<select id="list" resultType="com.bootdo.workDay.domain.WorkDayDO">
		select `Holiday_Id`,`Holiday_Name`,`Start_Day`,`End_Day`
		from holiday
		<where>
			<if test="holidayId != null and holidayId != ''"> and Holiday_Id = #{holidayId} </if>
			<if test="holidayName != null and holidayName != ''"> and Holiday_Name = #{holidayName} </if>
			<if test="startDay != null and startDay != ''"> and Start_Day = #{startDay} </if>
			<if test="endDay != null and endDay != ''"> and End_Day = #{endDay} </if>
		</where>
		<choose>
			<when test="sort != null and sort.trim() != ''">
				order by ${sort} ${order}
			</when>
			<otherwise>
				order by Holiday_Id desc
			</otherwise>
		</choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>

	<select id="listOfficeDay" resultType="com.bootdo.workDay.domain.WorkDayDO">
		select `Office_Id`,`Name`,`Office_Day` from office_day
		<where>
			<if test="officeId != null and officeId != ''"> and Office_Id = #{officeId} </if>
			<if test="name != null and name != ''"> and Name = #{name} </if>
			<if test="officeDay != null and officeDay != ''"> and Office_Day = #{officeDay} </if>
		</where>
		<choose>
			<when test="sort != null and sort.trim() != ''">
				order by ${sort} ${order}
			</when>
			<otherwise>
				order by Office_Id desc
			</otherwise>
		</choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>

	<select id="countOfficeDay" resultType="int">
		select count(*) from office_day
		<where>
			<if test="officeId != null and officeId != ''"> and Office_Id = #{officeId} </if>
			<if test="name != null and name != ''"> and Name = #{name} </if>
			<if test="officeDay != null and officeDay != ''"> and Office_Day = #{officeDay} </if>
		</where>
	</select>


	<select id="count" resultType="int">
		select count(*) from holiday
		<where>
			<if test="holidayId != null and holidayId != ''"> and Holiday_Id = #{holidayId} </if>
			<if test="holidayName != null and holidayName != ''"> and Holiday_Name = #{holidayName} </if>
			<if test="startDay != null and startDay != ''"> and Start_Day = #{startDay} </if>
			<if test="endDay != null and endDay != ''"> and End_Day = #{endDay} </if>
		</where>
	</select>

	<insert id="holiday" parameterType="com.bootdo.workDay.domain.WorkDayDO" useGeneratedKeys="true" keyProperty="holidayId">
		insert into work_day(Work_Day)
		select rep_date from obj_date a
		where not EXISTS(select * from holiday where a.rep_date &gt; Start_Day and a.rep_date &lt; End_Day)
		and DAYOFWEEK(rep_date)!=1 and DAYOFWEEK(rep_date)!=7
		and rep_year= #{currentYear}
	</insert>

	<insert id="save" parameterType="com.bootdo.workDay.domain.WorkDayDO" useGeneratedKeys="true" keyProperty="holidayId">
		insert into holiday
		(
			`Holiday_Name`,
			`Start_Day`,
			`End_Day`
		)
		values
		(
			#{holidayName},
			#{startDay},
			#{endDay}
		)
	</insert>

	<update id="update" parameterType="com.bootdo.workDay.domain.WorkDayDO">
		update holiday
		<set>
			<if test="holidayName != null">`Holiday_Name` = #{holidayName}, </if>
			<if test="startDay != null">`Start_Day` = #{startDay}, </if>
			<if test="endDay != null">`End_Day` = #{endDay}</if>
		</set>
		where Holiday_Id = #{holidayId}
	</update>

	<delete id="remove">
		delete from holiday where Holiday_Id = #{value}
	</delete>

	<delete id="batchRemove">
		delete from holiday where Holiday_Id in
		<foreach item="id" collection="array" open="(" separator="," close=")">
			#{holidayId}
		</foreach>
	</delete>

</mapper>