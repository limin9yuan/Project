<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

<title>BootDo</title>
<meta name="keywords" content="BootDo管理系统">
<meta name="description" content="BootDo管理系统">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/font-awesome.css?v=4.4.0" rel="stylesheet">
<link href="/css/animate.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link href="/css/login.css" rel="stylesheet">
<style media="screen">
	#idcode{
		margin-top: 5px;
		margin-right: 20px;
	}
	.ehong-idcode-val {
		position:relative;
		padding:1px 4px 1px 4px;
		top:0px;
		*top:-3px;
		letter-spacing:4px;
		display:inline;
		cursor:pointer;
		font-size:16px;
		font-family:"Courier New",Courier,monospace;
		text-decoration:none;
		font-weight:bold;
	}
	.ehong-idcode-val0 {
		border:solid 1px #A4CDED;
		background-color:#ECFAFB;
	}
	.ehong-idcode-val1 {
		border:solid 1px #A4CDED;
		background-color:#FCEFCF;
	}
	.ehong-idcode-val2 {
		border:solid 1px #6C9;
		background-color:#D0F0DF;
	}
	.ehong-idcode-val3 {
		border:solid 1px #6C9;
		background-color:#DCDDD8;
	}
	.ehong-idcode-val4 {
		border:solid 1px #6C9;
		background-color:#F1DEFF;
	}
	.ehong-idcode-val5 {
		border:solid 1px #6C9;
		background-color:#ACE1F1;
	}
</style>
<!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
<script>
	if (window.top !== window.self) {
		window.top.location = window.location;
	}
</script>

</head>

<body class="signin">
	<div class="signinpanel">
		<div class="row">
			<div class="col-sm-7">
				<div class="signin-info">
					<div class="logopanel m-b">
						<h1>海心信息</h1>
					</div>
					<div class="m-b"></div>
					<h3>
						欢迎使用 <strong>客户需求发展平台</strong>
					</h3>
					<ul class="m-b">
						<li><i class="fa fa-arrow-circle-o-right m-r-xs"></i>
							海心官网</li>
						<a class="outside-login-btn wxoa actived oschina J-btnSwitchLoginType" target="_Blank" href="/sales/projectConsultation/add">
						<li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 在线反馈</li></a>
						<li><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 项目咨询</li>


					</ul>

				</div>
			</div>
			<div class="col-sm-5">
				<form id="signupForm">
					<h3 class="text-center">用户登录</h3>
					<p class="m-t-md text-center">欢迎登录客户需求发展平台</p>
					<input type="text" name="username" class="form-control uname"
						value="admin" />
					<input type="password" name="password"
						class="form-control pword m-b" value="111111" />
					<div style="height: 50px;">
						<div class="" style="width: 110px; float:left;">
							<input style="width: 110px;margin-top:0px;" class="container" id="idcode-btn" class="form-control" placeholder="请输入验证码" maxlength="4" type="text">
							<span style="color:red;display: none;" class="tips"></span>
						</div>

						<div class="container" id="idcode" style="background: transparent;width: 170px; float:left;"></div>
					</div>

					<button class="btn btn-login btn-block" id="submit" type="submit">登录</button>
					<!--按钮模块-->
					<div class="outside-login">
						<div class="outside-login-tit">
							<span>相关链接</span>
						</div>
						<div class="outside-login-cot">
							<a class="outside-login-btn wxoa actived oschina J-btnSwitchLoginType" target="_Blank" href="http://www.hx-soft.com/a/aboutus/aboutus_development/">
								 <em><i class="fa fa-home"></i></em>
								 <span>发展历程</span>
							</a>
							<a class="outside-login-btn wxoa actived my J-btnSwitchLoginType" target="_Blank" href="">
								 <em><i class="fa fa-git-square"></i></em>
								 <span>行业论坛</span>
							</a>
							<a class="outside-login-btn wxoa actived git J-btnSwitchLoginType" target="_Blank" href="http://www.hx-soft.com/a/aboutus/aboutus_cooperation/">
								 <em><i class="fa fa-github"></i></em>
								 <span>合作伙伴</span>
							</a>
						</div>
					</div>

				</form>
			</div>
		</div>
		<div class="signup-footer">
			<div class="pull-left">
			</div>
		</div>
	</div>
	<!-- 全局js -->
	<script src="/js/jquery.min.js?v=2.1.4"></script>
	<script src="/js/bootstrap.min.js?v=3.3.6"></script>

	<!-- 自定义js -->
	<script src="/js/content.js?v=1.0.0"></script>

	<!-- jQuery Validation plugin javascript-->
	<script src="/js/plugins/validate/jquery.validate.min.js"></script>
	<script src="/js/plugins/validate/messages_zh.min.js"></script>
	<script src="/js/plugins/layer/layer.min.js"></script>
	<script type="text/javascript">
		var check = [false];
		var settings = {
			e: 'idcode',
			codeType: {
				name: 'follow',
				len: 4
			}, //len是修改验证码长度的
			codeTip: '换个验证码?',
			inputID: 'idcode-btn' //验证元素的ID
			};

			var _set = {
			storeLable: 'codeval',
			store: '#ehong-code-input',
			codeval: '#ehong-code'
		}
		//校验成功函数
		function success(Obj) {
		    Obj.removeClass('has-error').addClass('has-success');
		    $('.tips').eq(0).hide();
		    $('.glyphicon-ok').eq(0).show();
		    check[0] = true;

		}

		// 校验失败函数
		function fail(Obj, msg) {
		    Obj.removeClass('has-success').addClass('has-error');
		    $('.glyphicon-ok').eq(0).hide();
		    $('.tips').eq(0).text(msg).show();
		    check[0] = false;
		}
		$(document).ready(function() {
			validateRule();
			// 验证码
			$.idcode.setCode();

			$('#idcode-btn').change(function() {
			    var IsBy = $.idcode.validateCode();
			    if (IsBy) {
			        success($(this));
			    } else {
			        fail($(this), '验证码输入错误');
			    }
			});
			//$("#signupForm").validate();
		});
		$.validator.setDefaults({
			submitHandler : function() {

			   if (!check[0]) {
				    $('#idcode-btn').removeClass('has-success').addClass('has-error');
		   		    $('.glyphicon-ok').eq(0).hide();
		   		    $('.tips').eq(0).text('验证码输入错误').show();
		   		    check[0] = false;
					return;
			   }


				login();
			}
		});
		$.idcode = {
		    getCode: function(option) {
		        _commSetting(option);
		        return _storeData(_set.storeLable, null);
		    },
		    setCode: function(option) {
		        _commSetting(option);
		        _setCodeStyle("#" + settings.e, settings.codeType.name, settings.codeType.len);

		    },
		    validateCode: function(option) {
		        _commSetting(option);
		        var inputV;
		        if (settings.inputID) {
		            inputV = $('#' + settings.inputID).val();

		        } else {
		            inputV = $(_set.store).val();
		        }
		        if (inputV.toUpperCase() == _storeData(_set.storeLable, null).toUpperCase()) { //修改的不区分大小写
		            return true;
		        } else {
		            _setCodeStyle("#" + settings.e, settings.codeType.name, settings.codeType.len);
		            return false;
		        }
		    }
		};
		function _commSetting(option) {
		    $.extend(settings, option);
		}
		function _setCodeStyle(eid, codeType, codeLength) {
		    var codeObj = _createCode(settings.codeType.name, settings.codeType.len);
		    var randNum = Math.floor(Math.random() * 6);
		    var htmlCode = ''
		    if (!settings.inputID) {
		        htmlCode = '<span><input id="ehong-code-input" type="text" maxlength="4" /></span>';
		    }
		    htmlCode += '<div id="ehong-code" class="ehong-idcode-val ehong-idcode-val';
		    htmlCode += String(randNum);
		    htmlCode += '" href="#" onblur="return false" onfocus="return false" oncontextmenu="return false" onclick="$.idcode.setCode()">' + _setStyle(codeObj) + '</div>' + '<span id="ehong-code-tip-ck" class="ehong-code-val-tip" onclick="$.idcode.setCode()">' + settings.codeTip + '</span>';
		    $(eid).html(htmlCode);
		    _storeData(_set.storeLable, codeObj);
		}
		function _createCode(codeType, codeLength) {
		    var codeObj;
		    if (codeType == 'follow') {
		        codeObj = _createCodeFollow(codeLength);
		    } else if (codeType == 'calc') {
		        codeObj = _createCodeCalc(codeLength);
		    } else {
		        codeObj = "";
		    }
		    return codeObj;
		}
		function _createCodeFollow(codeLength) {
		    var code = "";
		    var selectChar = new Array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z');

		    for (var i = 0; i < codeLength; i++) {
		        var charIndex = Math.floor(Math.random() * selectChar.length);
		        if (charIndex % 2 == 0) {
		            code += selectChar[charIndex].toLowerCase();
		        } else {
		            code += selectChar[charIndex];
		        }
		    }
		    return code;
		}
		function _setStyle(codeObj) {
		    var fnCodeObj = new Array();
		    var col = new Array('#BF0C43', '#E69A2A', '#707F02', '#18975F', '#BC3087', '#73C841', '#780320', '#90719B', '#1F72D8', '#D6A03C', '#6B486E', '#243F5F', '#16BDB5');
		    var charIndex;
		    for (var i = 0; i < codeObj.length; i++) {
		        charIndex = Math.floor(Math.random() * col.length);
		        fnCodeObj.push('<font color="' + col[charIndex] + '">' + codeObj.charAt(i) + '</font>');
		    }
		    return fnCodeObj.join('');
		}
		function _storeData(dataLabel, data) {
		    var store = $(_set.codeval).get(0);
		    if (data) {
		        $.data(store, dataLabel, data);
		    } else {
		        return $.data(store, dataLabel);
		    }
		}



		function login() {
			$.ajax({
				type : "POST",
				url : "/login",
				data : $('#signupForm').serialize(),
				success : function(r) {
					if (r.code == 0) {
						parent.location.href = '/index';
					} else {
						layer.msg(r.msg);
					}
				}
			});
		}
		function validateRule() {
			var icon = "<i class='fa fa-times-circle'></i> ";
			$("#signupForm").validate({
				rules : {
					username : {
						required : true
					},
					password : {
						required : true
					}
				},
				messages : {
					username : {
						required : icon + "请输入您的用户名",
					},
					password : {
						required : icon + "请输入您的密码",
					}
				}
			})
		}
	</script>
</body>




</html>
